<div id="cart-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Your Cart</h2>
        <div class="cart-items">
            {% for item in cart_items %}
            <div class="cart-item">
                <img src="{{ url_for('static', filename=item.image) }}" 
                     alt="{{ item.name }}"
                     class="cart-item-image">
                <div>
                    <h3>{{ item.name }}</h3>
                    <p>£{{ "%.2f"|format(item.price) }} × {{ item.quantity }}</p>
                </div>
                <span>£{{ "%.2f"|format(item.item_total) }}</span>
            </div>
            {% else %}
            <p>Your cart is empty</p>
            {% endfor %}
        </div>
        <div class="cart-total">
            <p>Total: £{{ "%.2f"|format(cart_total) }}</p>
        </div>
        <a href="{{ url_for('cart') }}" class="btn">View Full Cart</a>
    </div>
</div>

<script>
    // Only run this script if the modal exists on the page
    const modal = document.getElementById("cart-modal");
    if (modal) {
        const cartLink = document.querySelector("nav a[href='{{ url_for('cart') }}']");
        const closeBtn = document.querySelector(".close");
        
        cartLink.addEventListener('click', function(event) {
            event.preventDefault();
            modal.style.display = "block";
        });
        
        closeBtn.addEventListener('click', function() {
            modal.style.display = "none";
        });
        
        window.addEventListener('click', function(event) {
            if (event.target === modal) {
                modal.style.display = "none";
            }
        });
    }
</script>
