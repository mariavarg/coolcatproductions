{% extends "base.html" %}

{% block title %}Add Album | CoolCat Productions{% endblock %}

{% block content %}
<div class="content-box" style="max-width: 800px; margin: 50px auto; padding: 30px;">
    <h2>Add New Album</h2>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('add_album') }}" enctype="multipart/form-data">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        
        <div style="margin-bottom: 20px;">
            <label for="title" style="display: block; margin-bottom: 8px; font-size: 1.1rem;">Album Title</label>
            <input type="text" id="title" name="title" required
                   style="width: 100%; padding: 12px; background: #222; color: #fff; border: 1px solid #333; border-radius: 4px;">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label for="artist" style="display: block; margin-bottom: 8px; font-size: 1.1rem;">Artist</label>
            <input type="text" id="artist" name="artist" required
                   style="width: 100%; padding: 12px; background: #222; color: #fff; border: 1px solid #333; border-radius: 4px;">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label for="year" style="display: block; margin-bottom: 8px; font-size: 1.1rem;">Year</label>
            <input type="text" id="year" name="year" required
                   style="width: 100%; padding: 12px; background: #222; color: #fff; border: 1px solid #333; border-radius: 4px;">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label for="price" style="display: block; margin-bottom: 8px; font-size: 1.1rem;">Price ($)</label>
            <input type="number" id="price" name="price" step="0.01" min="0" required
                   style="width: 100%; padding: 12px; background: #222; color: #fff; border: 1px solid #333; border-radius: 4px;">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label for="tracks" style="display: block; margin-bottom: 8px; font-size: 1.1rem;">
                Tracks (one per line) - MUST match MP3 upload order!
            </label>
            <textarea id="tracks" name="tracks" rows="5" required
                   style="width: 100%; padding: 12px; background: #222; color: #fff; border: 1px solid #333; border-radius: 4px;"
                   placeholder="Track 1&#10;Track 2&#10;Track 3"></textarea>
        </div>
        
        <div style="margin-bottom: 20px;">
            <label for="cover" style="display: block; margin-bottom: 8px; font-size: 1.1rem;">Album Cover</label>
            <input type="file" id="cover" name="cover" accept=".jpg,.jpeg,.png,.webp" required
                   style="width: 100%; padding: 12px; background: #222; color: #fff; border: 1px solid #333; border-radius: 4px;">
        </div>
        
        <!-- CRITICAL: MP3 UPLOAD FIELD -->
        <div style="margin-bottom: 30px;">
            <label for="music_files" style="display: block; margin-bottom: 8px; font-size: 1.1rem;">
                Music Files (MP3) - Upload in TRACK ORDER
            </label>
            <input type="file" id="music_files" name="music_files" multiple 
                   accept=".mp3" required
                   style="width: 100%; padding: 12px; background: #222; color: #fff; border: 1px solid #333; border-radius: 4px;">
            <div style="color: #ff6b6b; margin-top: 8px; font-size: 0.9rem;">
                ⚠️ Upload MP3 files in the exact same order as your track list above!
            </div>
        </div>
        
        <button type="submit" class="btn" style="width: 100%; padding: 12px; font-size: 1.1rem;">Add Album</button>
    </form>
</div>
{% endblock %}
